var jsregression=jsregression||{};!function(t){var a=function(t){(t=t||{}).iterations||(t.iterations=100),t.alpha||(t.alpha=1e-4),t.lambda||(t.lambda=0),this.iterations=t.iterations,this.alpha=t.alpha,this.lambda=t.lambda};a.prototype.fit=function(t){var a=t.length;this.dim=t[0].length;for(var i=[],s=[],h=0;h<a;++h){var r=t[h],o=[],e=r[r.length-1];o.push(1);for(var n=0;n<r.length-1;++n)o.push(r[n]);s.push(e),i.push(o)}this.theta=[];for(f=0;f<this.dim;++f)this.theta.push(0);for(var l=0;l<this.iterations;++l)for(var p=this.grad(i,s,this.theta),f=0;f<this.dim;++f)this.theta[f]=this.theta[f]-this.alpha*p[f];return{theta:this.theta,dim:this.dim,cost:this.cost(i,s,this.theta),config:{alpha:this.alpha,lambda:this.lambda,iterations:this.iterations}}},a.prototype.grad=function(t,a,i){for(var s=t.length,h=[],r=0;r<this.dim;++r){for(var o=0,e=0;e<s;++e){var n=t[e];o=-(a[e]-this.h(n,i))*n[r]}o=(o+this.lambda*i[r])/s,h.push(o)}return h},a.prototype.h=function(t,a){for(var i=0,s=0;s<this.dim;++s)i+=t[s]*a[s];return i},a.prototype.cost=function(t,a,i){for(var s=t.length,h=0,r=0;r<s;++r){var o=t[r],e=this.h(o,i);h+=(e-a[r])*(e-a[r])}for(var n=0;n<this.dim;++n)h+=this.lambda*i[n]*i[n];return h/(2*s)},a.prototype.transform=function(t){if(t[0].length){for(var a=[],i=0;i<t.length;++i){var s=this.transform(t[i]);a.push(s)}return a}var h=[];h.push(1);for(var r=0;r<t.length;++r)h.push(t[r]);return this.h(h,this.theta)},t.LinearRegression=a;var i=function(t){(t=t||{}).alpha||(t.alpha=.001),t.iterations||(t.iterations=100),t.lambda||(t.lambda=0),this.alpha=t.alpha,this.lambda=t.lambda,this.iterations=t.iterations};i.prototype.fit=function(t){this.dim=t[0].length;for(var a=t.length,i=[],s=[],h=0;h<a;++h){var r=t[h],o=[],e=r[r.length-1];o.push(1);for(var n=0;n<r.length-1;++n)o.push(r[n]);i.push(o),s.push(e)}this.theta=[];for(f=0;f<this.dim;++f)this.theta.push(0);for(var l=0;l<this.iterations;++l)for(var p=this.grad(i,s,this.theta),f=0;f<this.dim;++f)this.theta[f]=this.theta[f]-this.alpha*p[f];return{theta:this.theta,cost:this.cost(i,s,this.theta),config:{alpha:this.alpha,lambda:this.lambda,iterations:this.iterations}}},i.prototype.grad=function(t,a,i){for(var s=t.length,h=[],r=0;r<this.dim;++r){for(var o=0,e=0;e<s;++e){var n=t[e];o+=((this.h(n,i)-a[e])*n[r]+this.lambda*i[r])/s}h.push(o)}return h},i.prototype.h=function(t,a){for(var i=0,s=0;s<this.dim;++s)i+=a[s]*t[s];return 1/(1+Math.exp(-i))},i.prototype.transform=function(t){if(t[0].length){for(var a=[],i=0;i<t.length;++i){var s=this.transform(t[i]);a.push(s)}return a}var h=[];h.push(1);for(var r=0;r<t.length;++r)h.push(t[r]);return this.h(h,this.theta)},i.prototype.cost=function(t,a,i){for(var s=t.length,h=0,r=0;r<s;++r){var o=a[r],e=t[r];h+=-(o*Math.log(this.h(e,i))+(1-o)*Math.log(1-this.h(e,i)))/s}for(var n=0;n<this.dim;++n)h+=this.lambda*i[n]*i[n]/(2*s);return h},t.LogisticRegression=i;var s=function(t){(t=t||{}).alpha||(t.alpha=.001),t.iterations||(t.iterations=100),t.lambda||(t.lambda=0),this.alpha=t.alpha,this.lambda=t.lambda,this.iterations=t.iterations};s.prototype.fit=function(a,i){this.dim=a[0].length;var s=a.length;if(!i){i=[];for(f=0;f<s;++f){for(var h=!1,r=a[f][this.dim-1],o=0;o<i.length;++o)if(r==i[o]){h=!0;break}h||i.push(r)}}this.classes=i,this.logistics={};for(var e={},n=0;n<this.classes.length;++n){var l=this.classes[n];this.logistics[l]=new t.LogisticRegression({alpha:this.alpha,lambda:this.lambda,iterations:this.iterations});for(var p=[],f=0;f<s;++f){for(var u=[],o=0;o<this.dim-1;++o)u.push(a[f][o]);u.push(a[f][this.dim-1]==l?1:0),p.push(u)}e[l]=this.logistics[l].fit(p)}return e},s.prototype.transform=function(t){if(t[0].length){for(var a=[],i=0;i<t.length;++i){var s=this.transform(t[i]);a.push(s)}return a}for(var h=0,r="",o=0;o<this.classes.length;++o){var e=this.classes[o],n=this.logistics[e].transform(t);h<n&&(h=n,r=e)}return r},t.MultiClassLogistic=s}(jsregression),module&&(module.exports=jsregression);